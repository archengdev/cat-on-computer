<script src="https://cdn.jsdelivr.net/gh/netizenorg/netnet-standard-library/build/nn.min.js"></script>
<script>
/* global nn */

const GIF = 'IMG_0285.gif'
const COLOR = 'black'
function sleep (ms) {
    return new Promise(resolve => setTimeout(resolve, ms))
  }
async function setup() {
  nn.get('body').css({backgroundColor: COLOR})
  const landscape = nn.width > nn.height
  const size = (landscape ? nn.height : nn.width) / 2
  const gif = await nn.loadImage(GIF)
  // const x = (nn.width - size) / 2
  // const y = (nn.height - size) / 2
  const x = (nn.width - gif.width) / 2 + nn.randomInt(0, gif.width)
  const y = (nn.height - gif.height) / 2 + nn.randomInt(0, gif.height)
  
  const numCols = nn.width / (gif.width) / 2 + 2
  const numRows = nn.height / (gif.height) / 2 + 2
  for (let i = -numCols; i <= numCols; i++){
    for (let j = -numRows; j <= numRows; j++) {
      instantiate(x+i*gif.width,y+j*gif.height)
    }
  }
}

function instantiate(x,y) {  
  nn.create('img')
  .set({
    src: `${GIF}#${Math.random()}`})
  .css({
    position: 'absolute',
    left: x,
    top: y,
    imageRendering: 'pixelated'
  })
  .addTo('body')
}

let s = 1
function zoom () {
  requestAnimationFrame(zoom)
  document.body.style.transform = `scale(${s}, ${s})`;
  // document.body.style.transform = "scale(2,2)";
  // document.body.style.transform = `translate(${s},10)`
  s *=0.9995
}
  
  
nn.on('load', setup)
nn.on('load', zoom)
</script>